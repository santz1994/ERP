# Quty Karunia ERP - Environment Variables Template
# Copy this file to .env and update with your values

# ============================================================================
# ENVIRONMENT CONFIGURATION
# ============================================================================
# CRITICAL: Set ENVIRONMENT=production when deploying to production server
# This activates security restrictions (DEVELOPER role becomes READ-ONLY)
ENVIRONMENT=development

# Debug mode (MUST be False in production)
DEBUG=true
LOG_LEVEL=INFO

# ============================================================================
# API CONFIGURATION
# ============================================================================
API_TITLE=ERP Quty Karunia
API_VERSION=2.0.0
API_DESCRIPTION=Manufacturing Execution System - IKEA Standard
API_PREFIX=/api/v1

# ============================================================================
# SECURITY & JWT
# ============================================================================
# Current active SECRET_KEY - used to sign NEW JWT tokens
# CRITICAL: Generate strong 256-bit key using: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=your-super-secret-key-change-in-production-2026

# Historical SECRET_KEYs (comma-separated) - for validating OLD tokens during rotation
# Format: "old_key_1,old_key_2,old_key_3"
# Grace period: Keep last 3 keys (270 days total: 90 days × 3 keys)
# Example: "abc123xyz,def456uvw,ghi789rst"
SECRET_KEYS_HISTORY=

# Last SECRET_KEY rotation timestamp (ISO 8601 format)
# Updated automatically by scripts/rotate_secret_key.py
# Example: "2026-01-20T10:30:00"
KEY_LAST_ROTATED=

# SECRET_KEY rotation interval in days (default: 90 days)
# Recommended: 60-90 days per security best practices
KEY_ROTATION_DAYS=90

# JWT Algorithm (CRITICAL: Do NOT change unless you know what you're doing)
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24
JWT_REFRESH_EXPIRATION_DAYS=7

# ============================================================================
# DEPRECATED - Use SECRET_KEY instead
# ============================================================================
# JWT_SECRET_KEY=your-super-secret-key-change-in-production-2026

# ============================================================================
# CORS CONFIGURATION
# ============================================================================
CORS_ORIGINS=http://localhost:3000,http://localhost:8080,http://localhost:8000
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH
CORS_ALLOW_HEADERS=*

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================
REDIS_URL=redis://redis:6379/0
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0

# ============================================================================
# ADMIN CREDENTIALS
# ============================================================================
PGADMIN_DEFAULT_EMAIL=admin@erp.local
PGADMIN_PASSWORD=admin

GRAFANA_ADMIN_USER=admin
GRAFANA_PASSWORD=admin
GRAFANA_ADMIN_PASSWORD=admin

# ============================================================================
# EMAIL CONFIGURATION (Optional)
# ============================================================================
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM=noreply@quty-karunia.local

# ============================================================================
# AWS/S3 CONFIGURATION (For file uploads)
# ============================================================================
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key
AWS_S3_BUCKET=erp-quty-karunia
AWS_S3_REGION=ap-southeast-1

# ============================================================================
# TIMEZONE & LOCALIZATION
# ============================================================================
TIMEZONE=Asia/Jakarta
LANGUAGE=id
LANGUAGE_FALLBACK=en

# ============================================================================
# MONITORING & METRICS
# ============================================================================
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000
ENABLE_METRICS=true

# ============================================================================
# FILE UPLOAD
# ============================================================================
MAX_UPLOAD_SIZE=104857600  # 100MB in bytes
UPLOAD_DIR=/app/uploads

# ============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# ============================================================================
# Before deploying to production:
# 
# ✅ Set ENVIRONMENT=production
# ✅ Set DEBUG=false
# ✅ Change JWT_SECRET_KEY to strong random value (32+ characters)
# ✅ Update DATABASE_URL with production credentials
# ✅ Update CORS_ORIGINS with production frontend URL
# ✅ Verify PostgreSQL connection and credentials
# ✅ Run database migrations (alembic upgrade head)
# ✅ Test DEVELOPER role read-only restriction
# ✅ Verify audit trail is logging events
# ✅ Check /api/admin/environment-info endpoint
# 
# Security Features (Activated in PRODUCTION):
# - DEVELOPER role: READ-ONLY (cannot CREATE/UPDATE/DELETE/APPROVE/EXECUTE)
# - Audit trail: ALL operations logged with user, timestamp, IP
# - SoD enforcement: Purchasing MAKER ≠ CHECKER (separate approval)
# - Permission matrix: 22 roles × 15 modules with granular permissions
# 
# ============================================================================
# PRODUCTION OVERRIDES (uncomment for production)
# ============================================================================
# ENVIRONMENT=production
# DEBUG=false
# DATABASE_URL=postgresql://prod_user:prod_password@prod_host:5432/erp_prod
# JWT_SECRET_KEY=your-very-secure-production-key-minimum-32-characters
# CORS_ORIGINS=https://erp.quty-karunia.com
